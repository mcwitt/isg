#ifndef SAMPLE_H
#define SAMPLE_H

#include <stdio.h>

#define N       @N@
#define LOG_N   @LOG_N@
#define DILUTE  @DILUTE@

#if DILUTE
#define Z           @Z@
#define Z_MAX       @Z_MAX@
#define NUM_BONDS   (N*Z/2)
#else
#define Z_MAX       N
#define NUM_BONDS   (N*(N-1)/2)
#endif

#define IS_SITE_INDEX(i) ((i) >= 0 && (i) < N)

typedef struct
{
    int n[N*Z_MAX];
    double J4[N*Z_MAX];
    double h2m[N];
    double um;
    int z[N];
    int num_bonds;
    int bond_i[NUM_BONDS];
    int bond_j[NUM_BONDS];
    double bond_v[NUM_BONDS];
} sample_t;


void sample_init(sample_t *s);

void sample_add_bond(sample_t *s, int i, int j, double v);

void sample_read(sample_t *s, FILE *fp);

void reset_bonds(int n[N*Z_MAX],
                 double J4[N*Z_MAX],
                 int z[N],
                 double h2m[N],
                 double *um);

void add_bond(int i, int j, double v,
              int n[N*Z_MAX],
              double J4[N*Z_MAX],
              int z[N],
              double h2m[N],
              double *um);

#endif
