#include "sample.h"
#include "replica.h"
#include "rng.h"

#ifndef EXCHANGE_H
#define EXCHANGE_H

#define NUM_REPLICAS        @NUM_REPLICAS@
#define REPLICA_EXCHANGE    @REPLICA_EXCHANGE@

typedef struct
{
    const sample_t *sample;
    const double *beta;
    int ir[NUM_REPLICAS];  /* beta index -> replica index */
    int ib[NUM_REPLICAS];  /* replica index -> beta index */
    int swapped[NUM_REPLICAS];
    int S[N][NUM_REPLICAS];
    double h2[N][NUM_REPLICAS];
    double u[NUM_REPLICAS];

} exchange_t;

void exchange_init(exchange_t *x,
                   const sample_t *s,
                   const double beta[NUM_REPLICAS],
                   rng_t *rng);

void exchange_update(exchange_t *x, rng_t *rng);

#endif
